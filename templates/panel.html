{% extends "basebs.html" %}

{% block extracss %}
    <link rel="stylesheet" href="/static/css/jquery.fancybox.css?v={{ institucion.versionstaticscss }}" type="text/css" media="screen" />
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
:root {
    --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    --info-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    --success-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    --card-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
    --card-shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.18);
    --border-radius: 16px;
    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

* {
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    min-height: 100vh;
    line-height: 1.6;
}

/* Glass morphism effect */
.glass-card {
    background: rgba(255, 255, 255, 0.25);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.18);
    box-shadow: var(--card-shadow);
}

.card {
    border: none;
    border-radius: var(--border-radius);
    box-shadow: var(--card-shadow);
    transition: var(--transition);
    overflow: hidden;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: var(--card-shadow-hover);
}

.card-body {
    padding: 24px;
}

/* Enhanced Profile Card */
.profile-card {
    background: var(--primary-gradient);
    color: white;
    border: none;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(102, 126, 234, 0.3);
    margin-bottom: 24px;
    position: relative;
    text-align: center;
    overflow: hidden;
    transition: var(--transition);
}

.profile-card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: 0 25px 50px rgba(102, 126, 234, 0.4);
}

.profile-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 100%);
    pointer-events: none;
}

.profile-avatar {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    object-fit: cover;
    border: 4px solid rgba(255, 255, 255, 0.3);
    margin: 0 auto 20px;
    display: block;
    position: relative;
    z-index: 2;
    transition: var(--transition);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
}

.profile-avatar:hover {
    transform: scale(1.1);
    border-color: rgba(255, 255, 255, 0.6);
}

.profile-name {
    position: relative;
    z-index: 2;
    font-weight: 600;
    font-size: 1.4rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    margin-bottom: 0;
}

/* Enhanced Info Cards */
.info-card {
    background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
    border: 1px solid rgba(226, 232, 240, 0.8);
    border-radius: var(--border-radius);
    margin-bottom: 16px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.info-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: var(--primary-gradient);
}

.info-card:hover {
    transform: translateX(8px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.info-card .card-body {
    padding: 20px;
    padding-left: 24px;
}

.info-card h6 {
    margin-bottom: 12px;
    color: #1e293b;
    font-weight: 500;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
}

.info-card i {
    color: #667eea;
    margin-right: 12px;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(102, 126, 234, 0.1);
    border-radius: 8px;
    padding: 8px;
    font-size: 14px;
}


/* Enhanced Accordion */
.accordion {
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--card-shadow);
}

.accordion-item {
    border: none;
    margin-bottom: 2px;
}

.accordion-button {
    background: var(--primary-gradient);
    color: white;
    border: none;
    font-weight: 600;
    padding: 16px 20px;
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.accordion-button::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, transparent 100%);
    opacity: 0;
    transition: var(--transition);
}

.accordion-button:hover::before {
    opacity: 1;
}

.accordion-button:not(.collapsed) {
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
    color: white;
    box-shadow: none;
}

.accordion-button:focus {
    box-shadow: none;
    border: none;
}

.accordion-body {
    padding: 20px;
    background: rgba(255, 255, 255, 0.95);
}

/* Enhanced Search Input */
.search-input {
    border-radius: 30px;
    border: 2px solid rgba(102, 126, 234, 0.2);
    padding: 16px 24px;
    font-size: 1rem;
    transition: var(--transition);
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
}

.search-input:focus {
    border-color: #667eea;
    box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.15);
    background: white;
    outline: none;
}

.search-input::placeholder {
    color: #94a3b8;
    font-weight: 400;
}

/* Enhanced Module Cards - AJUSTADO PARA 6 POR FILA */
.module-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 12px;
    text-align: center;
    transition: var(--transition);
    border: 2px solid transparent;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    min-height: 140px;
    position: relative;
    overflow: hidden;
    box-shadow: var(--card-shadow);
    aspect-ratio: 1/1;
}

.module-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--primary-gradient);
    opacity: 0;
    transition: var(--transition);
    z-index: 0;
}

.module-card:hover::before {
    opacity: 0.05;
}

.module-card:hover {
    transform: translateY(-10px) scale(1.02);
    box-shadow: var(--card-shadow-hover);
    border-color: #667eea;
}

.module-card a {
    text-decoration: none;
    color: inherit;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100%;
    width: 100%;
    position: relative;
    z-index: 1;
}

.module-icon-img {
    width: 48px;
    height: 48px;
    object-fit: contain;
    margin-bottom: 10px;
    transition: var(--transition);
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
}

.module-card:hover .module-icon-img {
    transform: scale(1.15) rotate(5deg);
    filter: drop-shadow(0 8px 16px rgba(0, 0, 0, 0.2));
}

.module-title {
    font-size: 0.85rem;   /* antes 0.95rem */
    font-weight: 600;
    color: #1e293b;
    margin-bottom: 6px;
    line-height: 1.3;
    transition: var(--transition);
}

.module-card:hover .module-title {
    color: #667eea;
}

.module-description {
    font-size: 0.7rem;    /* antes 0.8rem */
    color: #64748b;
    line-height: 1.4;
    transition: var(--transition);
}

.module-card:hover .module-description {
    color: #475569;
}

/* Enhanced File Cards */
.file-icon-card {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
    border-radius: var(--border-radius);
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: var(--transition);
    border: 1px solid rgba(226, 232, 240, 0.8);
    box-shadow: var(--card-shadow);
    position: relative;
    overflow: hidden;
}

.file-icon-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: var(--success-gradient);
    opacity: 0;
    transition: var(--transition);
}

.file-icon-card:hover::before {
    opacity: 0.05;
}

.file-icon-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--card-shadow-hover);
    border-color: #667eea;
}

.file-icon {
    width: 48px;
    height: 48px;
    object-fit: contain;
    margin-bottom: 12px;
    transition: var(--transition);
    position: relative;
    z-index: 1;
}

.file-icon-card:hover .file-icon {
    transform: scale(1.1);
}

/* Enhanced Alerts */
.alert {
    border-radius: var(--border-radius);
    box-shadow: var(--card-shadow);
    border: none;
    margin-bottom: 24px;
    padding: 20px 24px;
    backdrop-filter: blur(10px);
    position: relative;
    overflow: hidden;
}

.alert::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 4px;
    height: 100%;
    background: currentColor;
}

.alert-danger {
    background: rgba(239, 68, 68, 0.1);
    color: #dc2626;
    border-left: 4px solid #dc2626;
}

.alert-success {
    background: rgba(34, 197, 94, 0.1);
    color: #16a34a;
    border-left: 4px solid #16a34a;
}

.alert-info {
    background: rgba(59, 130, 246, 0.1);
    color: #2563eb;
    border-left: 4px solid #2563eb;
}

/* Enhanced Swiper */
.swiper-container {
    border-radius: var(--border-radius);
    overflow: hidden;
    box-shadow: var(--card-shadow);
}

.swiper-slide img {
    transition: var(--transition);
}

.swiper-slide:hover img {
    transform: scale(1.05);
}

.swiper-pagination-bullet {
    background: #667eea;
    opacity: 0.5;
}

.swiper-pagination-bullet-active {
    opacity: 1;
    transform: scale(1.2);
}

/* Enhanced Tables */
.table {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
}

.table th {
    background: rgba(102, 126, 234, 0.1);
    color: #1e293b;
    font-weight: 600;
    border: none;
    padding: 16px;
}

.table td {
    border: none;
    padding: 12px 16px;
    vertical-align: middle;
}

.table tbody tr {
    transition: var(--transition);
}

.table tbody tr:hover {
    background: rgba(102, 126, 234, 0.05);
    transform: scale(1.01);
}

/* Loading Animation */
@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.loading-shimmer {
    position: relative;
    overflow: hidden;
}

.loading-shimmer::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
    animation: shimmer 1.5s infinite;
}

/* Floating Action Button */
.fab {
    position: fixed;
    bottom: 24px;
    right: 24px;
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--primary-gradient);
    color: white;
    border: none;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    transition: var(--transition);
    z-index: 1000;
}

.fab:hover {
    transform: scale(1.1);
    box-shadow: 0 12px 35px rgba(102, 126, 234, 0.6);
}

/* Responsive Design */
@media (max-width: 992px) {
    .module-card {
        aspect-ratio: unset;
        min-height: 120px;
        padding: 10px;
    }
    .module-icon-img {
        width: 40px;
        height: 40px;
    }
    .module-title {
        font-size: 0.9rem;
    }
    .module-description {
        font-size: 0.75rem;
    }
}

@media (max-width: 768px) {
    .profile-avatar {
        width: 100px;
        height: 100px;
    }
    .module-card {
        aspect-ratio: unset;
        min-height: 100px;
        padding: 8px;
    }
    .module-icon-img {
        width: 32px;
        height: 32px;
    }
    .module-title {
        font-size: 0.85rem;
    }
    .module-description {
        font-size: 0.7rem;
    }
    .btn-modern {
        font-size: 0.8rem;
        padding: 8px 16px;
    }
    .search-input {
        padding: 14px 20px;
        font-size: 0.95rem;
    }
    .card-body {
        padding: 20px;
    }
}

@media (max-width: 576px) {
    .container-fluid {
        padding-left: 16px;
        padding-right: 16px;
    }
    .module-card {
        aspect-ratio: unset;
        min-height: 80px;
        padding: 6px;
    }
    .module-icon-img {
        width: 24px;
        height: 24px;
    }
    .accordion-button {
        font-size: 0.9rem;
        padding: 14px 16px;
    }
    .profile-name {
        font-size: 1.2rem;
    }
    .fab {
        bottom: 16px;
        right: 16px;
        width: 50px;
        height: 50px;
        font-size: 20px;
    }
}

/* Scroll animations */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.animate-fade-in-up {
    animation: fadeInUp 0.6s ease-out;
}

/* Custom scrollbar */
::-webkit-scrollbar {
    width: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(226, 232, 240, 0.3);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: var(--primary-gradient);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

.profile-card .profile-avatar{
    width:92%;        /* ajusta 90-95 % si quieres m√°s o menos margen */
    height:auto;      /* respeta la proporci√≥n original */
    object-fit:cover; /* rellena sin deformar */
}

</style>
{% endblock %}

{% block heading %}
    <script src="/static/js/jquery.fancybox.pack.js?v={{ institucion.versionstaticsjs }}"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add scroll animations
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-fade-in-up');
                    }
                });
            }, observerOptions);

            // Observe all cards
            document.querySelectorAll('.card, .module-card, .file-icon-card').forEach(el => {
                observer.observe(el);
            });

            // Enhanced Swiper configuration
            if (document.querySelector('.swiper-container')) {
                var totalSlides = document.querySelectorAll('.swiper-slide').length;
                var breakpointsConfig = {
                    320: { slidesPerView: 1, spaceBetween: 10 },
                    640: { slidesPerView: 1, spaceBetween: 20 },
                    768: { slidesPerView: totalSlides >= 2 ? 2 : 1, spaceBetween: 30 },
                    1024: { slidesPerView: totalSlides >= 3 ? 3 : totalSlides, spaceBetween: 30 }
                };

                var mySwiper = new Swiper('.swiper-container', {
                    loop: totalSlides > 1,
                    slidesPerView: 'auto',
                    spaceBetween: 30,
                    autoplay: totalSlides > 1 ? {
                        delay: 5000,
                        disableOnInteraction: false,
                        pauseOnMouseEnter: true
                    } : false,
                    pagination: {
                        el: '.swiper-pagination',
                        clickable: true,
                        dynamicBullets: true
                    },
                    navigation: {
                        nextEl: '.swiper-button-next',
                        prevEl: '.swiper-button-prev',
                    },
                    breakpoints: breakpointsConfig,
                    effect: 'slide',
                    speed: 600,
                    parallax: true
                });

                // Enhanced Fancybox integration
                $('.swiper-slide img').each(function(index) {
                    $(this).wrap('<a href="' + $(this).attr('src') + '" data-fancybox="gallery" data-caption="' + $(this).attr('alt') + '"></a>');
                });
            }


            $('.module-card a')          // ya no dependemos de la clase .icon
                .hover(
                    function(){ $(this).addClass('hovered'); },
                    function(){ $(this).removeClass('hovered'); }
                )
                .click(function(e){
                    e.preventDefault();          // anulamos el link normal
                    bloqueointerface();

                    const url      = $(this).data('url');
                    const externo  = $(this).data('externo');

                    if (externo === 'si'){
                        // si no trae protocolo, se lo a√±adimos
                        const finalUrl = /^https?:\/\//i.test(url) ? url : 'http://' + url;
                        window.open(finalUrl, '_blank');
                        desbloqueointerface();
                    } else {
                        // rutas internas: garantizamos la ‚Äú/‚Äù inicial
                        const destino = (url.charAt(0) === '/') ? url : '/' + url;
                        window.location.href = destino;
                    }
                });


            // Enhanced module search with debouncing
            let searchTimeout;
            $("#searchmodule").on('input', function() {
                clearTimeout(searchTimeout);
                const searchTerm = $(this).val().trim().toUpperCase();

                searchTimeout = setTimeout(() => {
                    $('.module-item').each(function() {
                        const moduleName = $(this).data('nombre');
                        const moduleDesc = $(this).find('.module-description').text().toUpperCase();

                        if (searchTerm === '' || moduleName.includes(searchTerm) || moduleDesc.includes(searchTerm)) {
                            $(this).fadeIn(300);
                        } else {
                            $(this).fadeOut(300);
                        }
                    });

                    // Enhanced "No results" message
                    setTimeout(() => {
                        const visibleModules = $('.module-item:visible').length;
                        if (visibleModules === 0 && searchTerm !== '') {
                            if ($('#no-results').length === 0) {
                                $('.modules-grid').append(`
                            <div id="no-results" class="col-12 text-center py-5 animate-fade-in-up">
                                <div class="glass-card p-4 rounded-3">
                                    <i class="fas fa-search fa-3x text-muted mb-3"></i>
                                    <h5 class="text-muted">No se encontraron m√≥dulos</h5>
                                    <p class="text-muted mb-0">Intenta con otros t√©rminos de b√∫squeda</p>
                                </div>
                            </div>
                        `);
                            }
                        } else {
                            $('#no-results').remove();
                        }
                    }, 300);
                }, 300);
            });

            // Enhanced auto-hide alerts
            setTimeout(function() {
                $(".alert").each(function(index) {
                    setTimeout(() => {
                        $(this).fadeOut("slow");
                    }, index * 1000);
                });
            }, 30000);

            $("#ingresoportada").click(function() {
                bloqueointerface();
                $.ajax({
                    type: "POST",
                    url: "/bibliosearch",
                    data: {'action': 'portada', 'csrfmiddlewaretoken': csrftoken},
                    success: function(data) {
                        desbloqueointerface();
                        if (data.result === 'ok'){
                            $("#contenidocentral").html(data.pagina);
                        } else {
                            NotificacionAlerta(data.icono, data.titulo, data.mensaje);
                        }
                    },
                    error: function() {
                        desbloqueointerface();
                        NotificacionError('!!!', 'Error de conexi√≥n');
                    },
                    dataType: "json"
                });
            });

            // Enhanced library search
            $("#bibliosearch").click(function() {
                const searchTerm = $("#biblioinput").val().trim();
                if (searchTerm.length) {
                    $("#contenidocentral").addClass('loading-shimmer');
                    bloqueointerface();

                    $.ajax({
                        type: "POST",
                        url: "/bibliosearch",
                        data: {'action': 'busqueda', 'search': searchTerm, 'csrfmiddlewaretoken': csrftoken},
                        success: function(data) {
                            desbloqueointerface();
                            $("#contenidocentral").removeClass('loading-shimmer');
                            if (data.result === "ok") {
                                $("#contenidocentral").html(data.pagina);
                            } else {
                                NotificacionAlerta(data.icono, data.titulo, data.mensaje);
                            }
                        },
                        error: function() {
                            desbloqueointerface();
                            $("#contenidocentral").removeClass('loading-shimmer');
                            NotificacionError('Error', 'Error de conexi√≥n');
                        },
                        dataType: "json"
                    });
                }
            });

            // Enhanced book reservation
            $(".eliminarreserva").click(function() {
                const reservaId = $(this).attr("idr");
                const button = $(this);

                if (confirm('¬øEst√° seguro de que desea eliminar esta reserva?')) {
                    button.addClass('loading-shimmer');
                    bloqueointerface();

                    $.ajax({
                        type: "POST",
                        url: "/",
                        data: {"action": "eliminarreservalibro", "id": reservaId, 'csrfmiddlewaretoken': csrftoken},
                        success: function(data) {
                            if (data.result === "ok") {
                                button.closest('.d-flex').fadeOut(300, function() {
                                    $(this).remove();
                                });
                                setTimeout(() => location.reload(), 1000);
                            } else {
                                desbloqueointerface();
                                button.removeClass('loading-shimmer');
                                NotificacionAlerta(data.icono, data.titulo, data.mensaje);
                            }
                        },
                        error: function() {
                            desbloqueointerface();
                            button.removeClass('loading-shimmer');
                            NotificacionError('Error', 'Error de conexi√≥n');
                        },
                        dataType: "json"
                    });
                }
            });

            // Terms acceptance
            {% if terminosexiste %}
                $("#action-button").click();
            {% endif %}

            // Enhanced smooth scrolling
            $('a[href^="#"]').on('click', function(event) {
                const target = $(this.getAttribute('href'));
                if(target.length) {
                    event.preventDefault();
                    $('html, body').stop().animate({
                        scrollTop: target.offset().top - 120
                    }, 1000, 'easeInOutCubic');
                }
            });



            // Enhanced hover effects for cards
            $('.card, .module-card, .file-icon-card').hover(
                function() {
                    $(this).addClass('shadow-lg');
                },
                function() {
                    $(this).removeClass('shadow-lg');
                }
            );

            // Lazy loading for images
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            img.src = img.dataset.src;
                            img.classList.remove('loading-shimmer');
                            imageObserver.unobserve(img);
                        }
                    });
                });

                document.querySelectorAll('img[data-src]').forEach(img => {
                    img.classList.add('loading-shimmer');
                    imageObserver.observe(img);
                });
            }
        });

        $("#searchmodule").keyup(function () {
            var valor = $(this).val().trim().toUpperCase();
            if (valor.length > 0){
                $('.tituloicon[nombre!='+valor+']').parent().parent().parent().parent().hide();
                $('.tituloicon[nombre*='+valor+']').parent().parent().parent().parent().show();
            } else {
                $('.tituloicon').parent().parent().parent().parent().show();
            }
        }).focus();
    </script>
{% endblock %}

{% block canvas %}
    {% if terminosexiste %}
        <a hidden id="action-button" href="javascript:;" nhref="/account?action=aceptar&id={{ termino.id }}" class='btn btn-success btn-sm formmodal'>
            <i class="icon-plus"></i> Aceptar T√©rminos
        </a>
    {% endif %}

    {% if not alertanoticias and noticiasgraficas %}
        <div class="container-fluid mb-4">
            <div class="swiper-container">
                <div class="swiper-wrapper">
                    {% for noticia in noticiasgraficas %}
                        <div class="swiper-slide">
                            <img src="{{ noticia.imagen.download_link }}" alt="{{ noticia.titulo }}" style="width: 100%; height: 350px; object-fit: cover; border-radius: 16px;">
                        </div>
                    {% endfor %}
                </div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button-next"></div>
                <div class="swiper-button-prev"></div>
            </div>
        </div>
    {% endif %}

 {% if perfilprincipal.es_estudiante and hay_pendientes_pago %}
<div id="popup-pagos" class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"
     style="z-index: 2000; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(6px);">

  <div class="card text-center p-4 shadow-lg animate__animated animate__zoomIn"
       style="max-width: 560px; border-radius: 20px; z-index: 4000; background: linear-gradient(to bottom right, #fff3cd, #fde68a); border:2px solid #ffb703;">

    <!-- Icono / encabezado -->
    <div class="d-flex justify-content-center align-items-center mb-3" style="min-height: 120px;">
      <div class="rounded-circle shadow animate__animated animate__fadeInDown"
           style="width: 110px; height: 110px; border: 4px solid #e63946; background-color: #fff; display:flex; align-items:center; justify-content:center;">
        <i class="bi bi-exclamation-triangle-fill" style="font-size: 48px; color:#e63946;"></i>
      </div>
    </div>

    <h3 class="fw-bold mb-2" style="color:#7a2e00; text-shadow: 1px 1px 2px rgba(255,183,3,.3);">
      Atenci√≥n: pago pendiente
    </h3>

    <p class="text-muted fs-6 mb-3" style="line-height:1.4;">
      <strong>Reci√©n con el pago, la solicitud llega y se procesa.</strong><br>
      Sin pago, la solicitud no se env√≠a al destinatario.
    </p>

    <!-- Listado compacto de pendientes -->
    <div class="list-group text-start mb-3" style="border-radius:12px; overflow:hidden;">
      {% for s in pendientes_pago %}
      <div class="list-group-item d-flex justify-content-between align-items-center" style="gap:12px;">
        <div>
          <div class="fw-bold">{{ s.tipo.nombre }}</div>
          <div class="small text-muted">
            Tr√°mite: {{ s.numero_tramite|default:"‚Äî" }} ‚Ä¢ {{ s.fecha|date:"d/m/Y" }} {{ s.hora|time:"H:i" }}
          </div>
        </div>
        <div class="text-end">
          <div class="fw-bold">USD {{ s.valor|floatformat:2 }}</div>
          <a href="/alu_finanzas" class="btn btn-sm btn-primary mt-1">
            <i class="bi bi-credit-card"></i> Pagar ahora
          </a>
        </div>
      </div>
      {% endfor %}
    </div>

    <div class="d-flex justify-content-between">
      <a href="/alu_finanzas" class="btn btn-outline-secondary">
        Ver todos mis rubros
      </a>
      <button id="btn-cerrar-pagos" type="button" class="btn btn-success"
        onclick="cerrarPopup('popup-pagos');">
  Entendido
</button>


    </div>

    <div class="mt-3">
      <small class="text-muted">Tip: guarda el comprobante por si te lo solicitan.</small>
    </div>
  </div>
</div>
<script>
  function cerrarPopup(id){
    const overlay = document.getElementById(id);
    if(!overlay) return;

    const card = overlay.querySelector('.card');

    // Garantiza clases de animate.css
    overlay.classList.add('animate__animated');
    if (card) card.classList.add('animate__animated');

    // Animaciones de salida (overlay se desvanece, card se encoge)
    overlay.classList.add('animate__fadeOut');
    if (card){
      card.classList.remove('animate__zoomIn'); // por si la tra√≠a de entrada
      card.classList.add('animate__zoomOut');
    }

    // Remueve al terminar la animaci√≥n (y con timeout de respaldo)
    let done = false;
    const cleanup = () => {
      if (done) return;
      done = true;
      overlay.remove();
    };
    overlay.addEventListener('animationend', cleanup, { once: true });
    setTimeout(cleanup, 450); // fallback si no carga animate.css
  }
</script>


{% endif %}


    {% if notificar_deuda %}
        <img src="/static/images/notificaciondeuda.jpg" class="fancybox d-none" id="graficodeuda">
    {% endif %}

    <div class="container-fluid">
        <div class="row">
            <!-- Enhanced Sidebar Profile Section -->
            <div class="col-12 col-lg-3 mb-4">
                <!-- Enhanced Profile Card -->
                <div class="profile-card card">
                    <div class="card-body text-center">
                        <div class="mb-4">
                            {% if persona.foto %}
                                <img src="{{ persona.foto.foto.url }}" class="profile-avatar" alt="Profile">
                            {% else %}
                                <img src="/static/images/iconos/{% if persona.es_mujer %}mujer{% else %}hombre{% endif %}.png" class="profile-avatar" alt="Profile">
                            {% endif %}
                        </div>

                        <h4 class="profile-name mb-4">{{ persona }}</h4>

                        <div class="d-flex flex-wrap justify-content-center gap-2 mb-3">
                            {% if actualizar_foto %}
                                <a href="javascript:;" nhref="/account?action=cargarfoto" class="btn btn-info btn-sm btn-profile formmodal">
                                    <i class="fas fa-camera me-1"></i> Subir Foto
                                </a>
                            {% endif %}

                            {% if perfilprincipal.es_estudiante and reporte_0 and perfilprincipal.inscripcion.matriculado or perfilprincipal.inscripcion.graduado %}
                                <a class="btn btn-warning btn-sm btn-profile reportedirecto" href="javascript:;"
                                   tipos="{{ reporte_0.tiporeporte }}"
                                   nhref="/reportes?action=run&n={{ reporte_0.nombre }}&id={{ perfilprincipal.inscripcion.id }}&periodo={{ perfilprincipal.inscripcion.matricula.nivel.periodo.id }}">
                                    <i class="fas fa-id-card me-1"></i> Identificaci√≥n
                                </a>
                            {% endif %}

                            {% if perfilprincipal.es_administrativo and reporte_1 %}
                                <a class="btn btn-warning btn-sm btn-profile reportedirecto" href="javascript:;"
                                   tipos="{{ reporte_1.tiporeporte }}"
                                   nhref="/reportes?action=run&n={{ reporte_1.nombre }}&id={{ perfilprincipal.administrativo.id }}">
                                    <i class="fas fa-id-card me-1"></i> Identificaci√≥n
                                </a>
                            {% endif %}

                            {% if perfilprincipal.es_profesor and reporte_2 %}
                                <a class="btn btn-warning btn-sm btn-profile reportedirecto" href="javascript:;"
                                   tipos="{{ reporte_2.tiporeporte }}"
                                   nhref="/reportes?action=run&n={{ reporte_2.nombre }}&id={{ perfilprincipal.profesor.id }}">
                                    <i class="fas fa-id-card me-1"></i> Identificaci√≥n
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Enhanced Info Cards -->
                {% if perfilprincipal.inscripcion %}
                    <div class="info-card card">
                        <div class="card-body">
                            <h6><i class="fas fa-id-badge"></i> No. Identificaci√≥n: {{ persona.identificacion }}</h6>
                            <h6><i class="fas fa-user-graduate"></i> No. estudiante: {{ perfilprincipal.inscripcion.id }}</h6>
                            <h6><i class="fas fa-building"></i> Sede: {{ perfilprincipal.inscripcion.sede }}</h6>
                            <h6><i class="fas fa-graduation-cap"></i> {{ perfilprincipal.inscripcion.mi_malla }}</h6>
                            <h6><i class="fas fa-layer-group"></i> {{ perfilprincipal.inscripcion.mi_nivel }}</h6>
                        </div>
                    </div>
                {% elif perfilprincipal.administrativo %}
                    <div class="info-card card">
                        <div class="card-body">
                            <h6><i class="fas fa-id-badge"></i> No. Identificaci√≥n: {{ persona.identificacion }}</h6>
                            <h6><i class="fas fa-building"></i> Sede: {{ perfilprincipal.administrativo.sede }}</h6>
                            <h6><i class="fas fa-envelope"></i> Correo: {{ persona.emailinst }}</h6>
                        </div>
                    </div>
                {% elif perfilprincipal.profesor %}
                    <div class="info-card card">
                        <div class="card-body">
                            <h6><i class="fas fa-id-badge"></i> No. Identificaci√≥n: {{ persona.identificacion }}</h6>
                            <h6><i class="fas fa-building"></i> Sede: {{ perfilprincipal.profesor.coordinacion.sede }}</h6>
                            <h6><i class="fas fa-users"></i> Coordinaci√≥n: {{ perfilprincipal.profesor.coordinacion }}</h6>
                            <h6><i class="fas fa-envelope"></i> Correo: {{ persona.emailinst }}</h6>
                        </div>
                    </div>
                {% endif %}

                <!-- Enhanced Accordion Section -->
                {% if not perfilprincipal.es_empleador %}
                    <div class="accordion" id="sidebarAccordion">
                        {% if incidencias %}
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#incidenciasCollapse">
                                        <i class="fas fa-exclamation-triangle me-2"></i> INCIDENCIAS
                                    </button>
                                </h2>
                                <div id="incidenciasCollapse" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordion">
                                    <div class="accordion-body p-0">
                                        <div class="list-group list-group-flush">
                                            <a href="/incidencias" class="list-group-item list-group-item-action">
                                                <strong>TODAS</strong>
                                            </a>
                                            {% for i in incidencias %}
                                                <a href="/incidencias?i={{ i.id }}" class="list-group-item list-group-item-action">
                                                    {{ i.contenido|truncatechars:50 }}
                                                </a>
                                            {% endfor %}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if prof_cumple or ins_cumple %}
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#cumpleanosCollapse">
                                        <i class="fas fa-birthday-cake me-2"></i> CUMPLEA√ëOS
                                    </button>
                                </h2>
                                <div id="cumpleanosCollapse" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordion">
                                    <div class="accordion-body p-0">
                                        {% if ins_cumple %}
                                            <div class="table-responsive">
                                                <table class="table table-sm mb-0">
                                                    <thead class="table-light">
                                                    <tr>
                                                        <th>Estudiantes</th>
                                                        <th class="text-center">Edad</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for i in ins_cumple %}
                                                        <tr>
                                                            <td>{{ i }}{% if i.grupo %} - {{ i.grupo.nombre }}{% endif %}</td>
                                                            <td class="text-center">{{ i.persona.edad|floatformat:0 }}</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        {% endif %}

                                        {% if prof_cumple %}
                                            <div class="table-responsive">
                                                <table class="table table-sm mb-0">
                                                    <thead class="table-light">
                                                    <tr>
                                                        <th>Docentes</th>
                                                        <th class="text-center">Edad</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    {% for p in prof_cumple %}
                                                        <tr>
                                                            <td>{{ p.persona }}</td>
                                                            <td class="text-center">{{ p.persona.edad|floatformat:0 }}</td>
                                                        </tr>
                                                    {% endfor %}
                                                    </tbody>
                                                </table>
                                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% if not cliente %}
                        <div class="accordion-item">
                            <h2 class="accordion-header">
                                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#bibliotecaCollapse">
                                    <i class="fas fa-book me-2"></i> BIBLIOTECA
                                </button>
                            </h2>
                            <div id="bibliotecaCollapse" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordion">
                                <div class="accordion-body">

                                    <div id="otraslibs" align="center">
                                        <br/>
                                        <a href="javascript:;" id="ingresoportada"><img style="height: 80px;" src='/static/images/iconos/documentos.png'><h5>Bibliotecas UTI</h5></a>
                                    </div>
                                    {% if reservaslibros %}
                                        <div>
                                            <h6><i class="fas fa-bookmark"></i> Reservas documentos</h6>
                                            {% for reserva in reservaslibros %}
                                                <div class="d-flex align-items-center mb-2">
                                                    <button class="btn btn-danger btn-sm me-2 eliminarreserva" idr="{{ reserva.id }}" title="Liberar reserva">
                                                        <i class="fas fa-times"></i>
                                                    </button>
                                                    <small>{{ reserva.documento|truncatechars:35 }}</small>
                                                </div>
                                            {% endfor %}
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endif %}


                    </div>
                {% endif %}
            </div>

            <!-- Enhanced Main Content -->
            <div class="col-12 col-lg-9" id="contenidocentral">
                <!-- Enhanced Alerts Section -->
                {% if not empleador %}
                    {% if documentossinentregar %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            <h5><i class="fas fa-exclamation-triangle me-2"></i> AVISO IMPORTANTE</h5>
                            Ud. debe entregar {{ documentossinentregar }} documento(s) a la Biblioteca
                        </div>
                    {% endif %}

                    {% if persona.mi_cumpleannos %}
                        <div class="alert alert-success alert-dismissible fade show">
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            <h5><i class="fas fa-birthday-cake me-2"></i> ¬°FELICIDADES!</h5>
                            La {{ institucion.nombre }} espera que hoy pases un feliz d√≠a en compa√±√≠a de tus familiares y seres amados. ¬°FELIZ CUMPLEA√ëOS!
                        </div>
                    {% endif %}

                   {% if persona.mi_cumpleannos %}
<div id="popup-cumple">
  <!-- üéÇ MODAL DE FELICITACI√ìN -->
  <div class="position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center"
       style="z-index: 2000; background-color: rgba(0,0,0,0.7); backdrop-filter: blur(6px);">

      <div class="card text-center p-4 shadow-lg animate__animated animate__zoomIn"
           style="max-width: 500px; border-radius: 20px; z-index: 4000; background: linear-gradient(to bottom right, #f3e8ff, #ede9fe);">

         <div class="d-flex justify-content-center align-items-center mb-3" style="min-height: 150px;">
    <div class="rounded-circle shadow animate__animated animate__fadeInDown"
         style="width: 130px; height: 130px; border: 4px solid #9333ea; box-shadow: 0 4px 20px rgba(0,0,0,0.3); background-color: #ede9fe; display: flex; align-items: center; justify-content: center; overflow: hidden;">
       {% if persona.foto %}
        <img src="{{ persona.foto.foto.url }}"
             style="width: 100%; height: 100%; object-fit: cover;">
    {% else %}
        <img src="/static/images/iconos/{% if persona.es_mujer %}mujer{% else %}hombre{% endif %}.png"
             style="width: 70%; height: 70%; object-fit: contain;">
    {% endif %}

    </div>
</div>


          <h3 class="fw-bold mb-2" style="color: #6b21a8; text-shadow: 1px 1px 2px #d8b4fe;"><i class="fas fa-birthday-cake me-2"></i> ¬°Feliz cumplea√±os, {{ persona.nombre_apellido_principal|title }}!</h3>

          <p class="text-muted fs-5 mb-2">
              Hoy celebramos tu vida y el privilegio de tenerte como parte de esta gran familia.
          </p>
        {% if perfilprincipal.es_estudiante %}
    <p class="text-secondary mb-4">
        Hoy comienza un nuevo cap√≠tulo en tu historia. Sigue aprendiendo, so√±ando y creciendo.
        Recuerda que en la Universidad Indoam√©rica creemos en ti: <strong>¬°Crea tu propia historia!</strong>
    </p>
{% else %}
    <p class="text-secondary mb-4">
        Gracias por tu energ√≠a, tu compromiso y tu esencia.
        Que este nuevo a√±o de vida est√© lleno de logros, paz y alegr√≠a.
    </p>
{% endif %}
          <p class="text-muted">
              ‚Äî Con aprecio, <strong>{{ institucion.nombre }}</strong> üíú
          </p>

{#          <a href=" " class="btn fw-bold mt-3" style="background-color: #9333ea; color: white;">#}
{#              üéì Descargar Certificado de Cumplea√±os#}
{#          </a>#}

     <div class="fw-bold mt-3 text-center"
     style="background-color: #9333ea; color: white; padding: 10px 20px; border-radius: 0.375rem; display: inline-block;">
    üíú Con cari√±o de la Universidad Indoam√©rica
</div>


          <button class="btn btn-outline-secondary mt-3" onclick="document.getElementById('popup-cumple').remove();">Cerrar</button>
      </div>
  </div>

  <!-- üéà CONTENEDOR DE GLOBOS -->
  <div class="balloon-container" aria-hidden="true" id="balloon-container"></div>
</div>

<!-- üéä CONFETTI LIBRARY -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<!-- üéâ EFECTO CONFETTI CONSTANTE -->
<script>
  let confettiInterval;
  document.addEventListener("DOMContentLoaded", function () {
    const defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 5000 };

    function randomInRange(min, max) {
      return Math.random() * (max - min) + min;
    }

    function launchConfetti() {
      confetti(Object.assign({}, defaults, {
        particleCount: 10,
        origin: {
          x: randomInRange(0.1, 0.9),
          y: Math.random() - 0.2
        }
      }));
    }

    confettiInterval = setInterval(() => {
      if (document.getElementById("popup-cumple")) {
        launchConfetti();
      } else {
        clearInterval(confettiInterval);
      }
    }, 500);
  });
</script>

<!-- üéà GLOBOS ALEATORIOS -->
<script>
  function createBalloon() {
    const balloon = document.createElement("div");
    const colors = ["#f87171", "#60a5fa", "#a78bfa", "#34d399", "#facc15", "#fb923c"];
    const left = Math.floor(Math.random() * 100);
    const color = colors[Math.floor(Math.random() * colors.length)];
    balloon.className = "balloon";
    balloon.style.left = `${left}%`;
    balloon.style.background = color;

    document.getElementById("balloon-container").appendChild(balloon);

    setTimeout(() => {
      balloon.remove();
    }, 10000);
  }

  const balloonInterval = setInterval(() => {
    if (document.getElementById("popup-cumple")) {
      createBalloon();
    } else {
      clearInterval(balloonInterval);
    }
  }, 600);
</script>

<!-- üé® CSS GLOBOS -->
<style>
  .balloon-container {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 3000;
    pointer-events: none;
  }

  .balloon {
    position: absolute;
    bottom: -100px;
    width: 50px;
    height: 70px;
    border-radius: 50% 50% 45% 45%;
    opacity: 0.9;
    animation: floatBalloon 10s linear;
  }

  .balloon::after {
    content: '';
    position: absolute;
    width: 2px;
    height: 20px;
    background: #444;
    bottom: -20px;
    left: 50%;
    transform: translateX(-50%);
  }

  @keyframes floatBalloon {
    0% { transform: translateY(0) scale(1); opacity: 0.8; }
    100% { transform: translateY(-120vh) scale(1.2); opacity: 0; }
  }
</style>

<!-- üé® Animate.css -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
{% endif %}



                    <!-- Enhanced News Section -->
                    {% for noticia in noticias %}
                        <div class="alert {% if noticia.tipo == 2 %}alert-danger{% else %}alert-info{% endif %} alert-dismissible fade show">
                            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                            <h5>{{ noticia.titular }}</h5>
                            {% autoescape on %}
                                {{ noticia.cuerpo|safe|urlize }}
                            {% endautoescape %}
                        </div>
                    {% endfor %}
                {% endif %}

                <!-- Enhanced Modules Section -->
                <!-- ===== Secci√≥n de m√≥dulos ========================== -->
                <div class="row">
                    <div class="col-12">

                        <!-- Encabezado --------------------------------------------------- -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4 class="mb-0 fw-bold">
                                <i class="fas fa-th-large me-2 text-primary"></i> M√≥dulos Disponibles
                                {% if grupos_con_mods %}
                                    <small class="text-muted d-block mt-1">
                                        Grupos:
                                        {% for gm in grupos_con_mods %}
                                            {{ gm.grupo.name }}{% if not forloop.last %}, {% endif %}
                                        {% endfor %}
                                    </small>
                                {% endif %}
                            </h4>
                        </div>

                        <!-- Buscador ----------------------------------------------------- -->
                        <div class="mb-4">
                            <input type="text" id="searchmodule"
                                   class="form-control search-input"
                                   placeholder="üîç Buscar m√≥dulos por nombre o descripci√≥n‚Ä¶">
                        </div>

                        <!-- Grid agrupado por grupo ------------------------------------- -->
                        {% for gm in grupos_con_mods %}
                            <!-- T√≠tulo del grupo -->
                            <h5 class="fw-semibold mt-4 border-bottom">
                                <i class="fas fa-layer-group me-1 text-primary"></i>
                                {{ gm.grupo.name }}
                            </h5>

                            <!-- Tarjetas del grupo (¬°ojo a la row!) -->
                            <div class="row modules-grid">
                                {% for modulo in gm.modulos_activos %}
                                    <div class="col-6 col-md-4 col-lg-2 mb-4 module-item"
                                         data-nombre="{{ modulo.nombre|upper }}"
                                         data-grupo="{{ gm.grupo.name|slugify }}">

                                        <div class="module-card">
                                            <a  href="{% if modulo.url|slice:':1' == '/' %}{{ modulo.url }}{% else %}/{{ modulo.url }}{% endif %}"
                                                data-url="{{ modulo.url }}"
                                                data-externo="{% if modulo.externo %}si{% else %}no{% endif %}"
                                                {% if modulo.externo %}target="_blank"{% endif %}>

                                                <img src="/static/images/iconos/{{ modulo.url }}.png" alt="{{ modulo.nombre }}"
                                                     class="module-icon-img"
                                                     onerror="this.onerror=null; this.src='/static/images/iconos/sin_icono.png';"/>

                                                <div class="module-title">{{ modulo.nombre }}</div>
                                                <div class="module-description">
                                                    {{ modulo.descripcion|truncatechars:60 }}
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                            {% empty %}
                            <p class="text-muted">No hay m√≥dulos disponibles.</p>
                        {% endfor %}
                    </div>
                </div>

                <!-- Enhanced General Files Section -->
                {% if archivos %}
                    <div class="row mt-5">
                        <div class="col-12">
                            <h4 class="mb-4 fw-bold">
                                <i class="fas fa-folder-open me-2 text-primary"></i> Archivos Generales
                            </h4>
                            <div class="row">
                                {% for archivo in archivos %}
                                    <div class="col-6 col-sm-4 col-md-3 col-lg-2 mb-3">
                                        <div class="file-icon-card" onclick="window.open('{{ archivo.archivo.url }}', '_blank')">
                                            {% if archivo.tipo_archivo == "pdf" %}
                                                <img src='/static/images/iconos/pdf.png' class="file-icon" alt="PDF">
                                            {% elif archivo.tipo_archivo == "doc" or archivo.tipo_archivo == 'docx' %}
                                                <img src='/static/images/iconos/word.png' class="file-icon" alt="Word">
                                            {% elif archivo.tipo_archivo == "xls" or archivo.tipo_archivo == 'xlsx' %}
                                                <img src='/static/images/iconos/excel.png' class="file-icon" alt="Excel">
                                            {% else %}
                                                <img src='/static/images/iconos/txt.png' class="file-icon" alt="Text">
                                            {% endif %}
                                            <div class="small text-truncate fw-medium">{{ archivo.nombre }}</div>
                                        </div>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}