{% extends "emails/emailbase.html" %}
{% load ctt_extras %}
{% block contenido %}
    <p><b>Cierre de materia:</b> {{ materia.nombre_simple }}</p>
    <table class="table table-bordered">
        <thead class="table-light">
        <tr>
            <th>Estudiantes</th>
            {% for campo in materia.modeloevaluativo.campos %}
                <th style="text-align: center; width: 35px; vertical-align: middle;"><a data-bs-toggle="tooltip" data-bs-placement="top" title="{{ campo.alternativa }}">{{ campo.nombre }}</a></th>
            {% endfor %}
            <th style="text-align: center; width: 50px;">Nota Final</th>
            <th style="text-align: center; width: 50px;">Asist.</th>
            <th style="text-align: center; width: 50px;">Clases</th>
            <th style="text-align: center; width: 100px;">Estado</th>
        </tr>
        </thead>
        <tbody>
        {% for asignadomateria in materia.asignados_a_esta_materia %}
            <tr>
                <td>{{ asignadomateria.matricula.inscripcion }}</td>
                {% for campo in materia.modeloevaluativo.campos %}
                    {% with valor=asignadomateria|args:campo.nombre|call:"valor_nombre_campo" %}
                        <td style="text-align: center;vertical-align: middle;font-size: 11px;">{{ valor|floatformat:campo.decimales }}</td>
                    {% endwith %}
                {% endfor %}
                <td style="text-align: center;vertical-align: middle;">{{ asignadomateria.notafinal }}</td>
                <td style="text-align: center;vertical-align: middle;">
                    {% if not asignadomateria.porciento_requerido %}
                        <span style="color: #ff0000;"><b>{{ asignadomateria.asistenciafinal|floatformat:0 }}%</b></span>
                    {% else %}
                        <span style="color:#006400;"><b>{{ asignadomateria.asistenciafinal|floatformat:0 }}%</b></span>
                    {% endif %}
                </td>
                <td style="text-align: center;vertical-align: middle;">
                    {{ asignadomateria.promedio_evaluacion_clase }} ({{ asignadomateria.cantidad_evaluaciones_clase }})
                </td>
                <td style="text-align: center;vertical-align: middle;">
                    {% if asignadomateria.aprobada %}
                        <span id='maestado{{ asignadomateria.id }}' style="color: #006400;"><b>{{ asignadomateria.estado }}</b></span>{% endif %}
                    {% if asignadomateria.reprobado %}
                        <span id='maestado{{ asignadomateria.id }}' style="color: #dc143c;"><b>{{ asignadomateria.estado }} </b></span>
                    {% endif %}
                </td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
{% endblock %}