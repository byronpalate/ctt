{% extends "formbs.html" %}
{% block extrajavascript %}
    <script type="text/javascript">
        $(function() {

            const $chkTodas = $("#id_todas");
            const $selForma = $("#id_formadepago");

            function ensureMessageNode() {
                if ($("#todas-msg").length === 0) {
                    $chkTodas.after(
                        '<div id="todas-msg" class="alert alert-info mt-2" style="display:none;">' +
                        'Se generan los descuentos para todas las formas de pago con las mismas fechas y mismo porcentaje.' +
                        '</div>'
                    );
                }
            }

            function toggleTodasUI() {
                ensureMessageNode();
                if ($chkTodas.is(":checked")) {
                    $selForma.val("").prop("disabled", true);
                    $("#todas-msg").stop(true, true).slideDown(150);
                } else {
                    $selForma.prop("disabled", false);
                    $("#todas-msg").stop(true, true).slideUp(150);
                }
            }

            $chkTodas.on("change", toggleTodasUI);
            // Estado inicial al abrir el modal
            toggleTodasUI();

        });
    </script>
{% endblock %}
{% block atras %}/adm_pagosnivel{% endblock %}
{% block titulo %}{{ title }}{% endblock %}
{% block formaction %}/adm_pagosnivel{% endblock %}
{% block formdestination %}/adm_pagosnivel?action=descuentoformapago&id={{ precio.id }}{% endblock %}
{% block formextra %}
    <input type='hidden' name='action' value='addformapago'/>
    <input type='hidden' name='pid' value='{{ precio.id }}'/>
{% endblock %}
{% block formback %}/adm_pagosnivel{% endblock %}
