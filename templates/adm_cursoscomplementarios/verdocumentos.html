{% extends "basebs.html" %}
{% load ctt_extras %}
{% block heading %}
    <script type="text/javascript">
        $(function () {
            // Captura el clic en el botón Observar
            $(".btn-observar").click(function () {
                // Obtiene la URL del documento asociado al botón Observar
                var urlDocumento = $(this).data("url");
                // Carga la URL del documento en el visor de PDF
                $("#visor-pdf").attr("src", urlDocumento);
            });
        });
    </script>
{% endblock %}
{% block atras %}/adm_cursoscomplementarios?action=registrados&id={{ registrado.curso.id }}{% endblock %}
{% block headcanvas %}
    <div class='row mb-2'>
        <div class="col-12">
            <h4>{{ title }}
                <br>Estudiante: {{ registrado.inscripcion.persona }}
                {% if registrado.retirado %}<span class="badge text-bg-danger">RETIRADO</span>{% endif %}
            </h4>
        </div>
    </div>
    <div class="row">
        <div class="col-12 mb-2">
            <a href="javascript:;" nhref="/adm_cursoscomplementarios?action=adddoc&id={{ registrado.id }}" class="btn btn-sm btn-success formmodal"><i class="icon-plus"></i> Adicionar</a>
        </div>
    </div>
{% endblock %}
{% block canvas %}
    <div class='row container-fluid'>
        <div class='col-6'>
            <table class='table table-bordered'>
                <thead class="table-light">
                <tr>
                    <th style="width: 350px">Nombre</th>
                    <th style="width: 90px; text-align: center;">Descargar</th>
                    <th style="width: 90px; text-align: center;">Revisar</th>
                    <th style="width: 120px; text-align: center;">Eliminar</th>
                </tr>
                </thead>
                <tbody>
                {% for doc in documentos %}
                    <tr>
                        <td>{{ doc.nombre }}</td>
                        <td style="text-align: center">
                            <a class="btn btn-ssm btn-success" href="{{ doc.archivo.url }}" target="_blank"><i class="icon-download-alt"></i></a>
                        </td>
                        <td style="text-align: center">
                            <a class="btn btn-ssm btn-info btn-observar" data-url="{{ doc.archivo.url }}" target="_blank"><i class="icon-eye-open"></i></a>
                        </td>
                        <td style="text-align: center;">
                            <a href="javascript:;" nhref="/adm_cursoscomplementarios?action=deldoc&id={{ doc.id }}&idm={{ registrado.id }}" class="btn btn-danger btn-ssm eliminacionmodal tu" data-bs-toggle="tooltip" data-bs-placement="top" title="Eliminar"><i class="icon-remove"></i></a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="20">NO EXISTEN DATOS</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-md-6">
            <div style="text-align: center;">
                <h3>Vizualización de Documento</h3>
                <!-- Aquí va el iframe del visor de PDF -->
                <embed id="visor-pdf" src="" type="application/pdf" width="100%" height="600" style="border: 1px solid #ccc; border-radius: 5px; box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.5)" sandbox="allow-top-navigation! allow-scripts!">
            </div>
        </div>
    </div>
{% endblock %}